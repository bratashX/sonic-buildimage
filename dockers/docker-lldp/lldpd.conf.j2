{% set mgmt_if = {} %}
{% if MGMT_INTERFACE %}
{% for interface in MGMT_INTERFACE.keys()|list %}
{% if not ':' in interface[1] %}
{% if mgmt_if.update({'port_name' : interface[0]}) %} {% endif %}
{% if mgmt_if.update({'ipv4' : interface[1].split('/')[0]}) %} {% endif %}
{% endif %}
{% endfor %}
{% endif %}
{% if mgmt_if %}
{# If MGMT port alias is available, use it for port ID subtype, otherwise use port name #}
{% if MGMT_PORT and MGMT_PORT[mgmt_if.port_name] and MGMT_PORT[mgmt_if.port_name].alias %}
configure ports eth0 lldp portidsubtype local {{ MGMT_PORT[mgmt_if.port_name].alias }}
{% else %}
configure ports eth0 lldp portidsubtype local {{ mgmt_if.port_name }}
{% endif %}
configure system ip management pattern {{ mgmt_if.ipv4 }}
{% endif %}
configure system hostname {{ DEVICE_METADATA['localhost']['hostname'] }}
